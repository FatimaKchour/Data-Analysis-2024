import pandas as pd

# Load the Excel file
file_path = 'path_to_your_file/TOTAL_acquisition_results_NewApproach_3.xlsx'
df = pd.read_excel(file_path, sheet_name='Sheet1')

# Extracting relevant columns
df_relevant = df[['TIMESTAMP_INITIAL', 'TIMESTAMP_FINAL', 'GLANCE_DURATION', 'GLANCE_DURATION_milliseconds', 'Glance_Type']]

# Forward filling the NaN values within each interval
df_relevant = df_relevant.ffill()

# Merging the filled columns back into the original dataframe
df.update(df_relevant)

# Saving the updated dataframe to a new Excel file
output_path = 'path_to_save/Updated_acquisition_results.xlsx'
df.to_excel(output_path, index=False)
